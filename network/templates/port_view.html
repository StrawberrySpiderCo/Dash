{% extends 'base.html' %}
{% load static %}
{% csrf_token %}
{% block title %}Network{% endblock %}
{% block template %}
<h2>Port View</h2>
<button onclick="selectAll()">Select All</button>
<button onclick="unselectAll()">Unselect All</button>
<form id="editForm" action="{% url 'edit_ports' %}" method="post">
  {% csrf_token %}
  <input type="hidden" name="selected_ports" id="selectedPorts">
  <input type="submit" value="Edit Selected">
</form>
<table>
    <thead>
      <tr>
        <th>Select</th>
        <th>Name</th>
        <th>Description</th>
        <th>MAC Address</th>
        <th>MTU</th>
        <th>Bandwidth</th>
        <th>Media Type</th>
        <th>Duplex</th>
        <th>Line Protocol</th>
        <th>Operational Status</th>
        <th>Interface Type</th>
        <th>IPv4 Address</th>
        <th>IPv4 Subnet</th>
      </tr>
    </thead>
    <tbody>
      {% for interface in device_interfaces %}
      <tr>
        <td><input type="checkbox" name="port" value="{{ interface.id }}"></td>
        <td>{{ interface.name }}</td>
        <td>{{ interface.description }}</td>
        <td>{{ interface.mac_address }}</td>
        <td>{{ interface.mtu }}</td>
        <td>{{ interface.bandwidth }}</td>
        <td>{{ interface.media_type }}</td>
        <td>{{ interface.duplex }}</td>
        <td>{{ interface.line_protocol }}</td>
        <td>{{ interface.oper_status }}</td>
        <td>{{ interface.interface_type }}</td>
        <td>{{ interface.ipv4_address }}</td>
        <td>{{ interface.ipv4_subnet }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
<script>
  function selectAll() {
    var checkboxes = document.querySelectorAll('input[name="port"]');
    checkboxes.forEach(function(checkbox) {
      checkbox.checked = true;
    });
    updateSelectedPorts();
  }

  function unselectAll() {
    var checkboxes = document.querySelectorAll('input[name="port"]');
    checkboxes.forEach(function(checkbox) {
      checkbox.checked = false;
    });
    updateSelectedPorts();
  }

  function updateSelectedPorts() {
    var selectedPorts = [];
    var checkboxes = document.querySelectorAll('input[name="port"]:checked');
    checkboxes.forEach(function(checkbox) {
      selectedPorts.push(checkbox.value);
    });
    document.getElementById('selectedPorts').value = JSON.stringify(selectedPorts);
  }
</script>
